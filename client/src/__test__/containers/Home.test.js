import React from 'react';
import configureMockStore from 'redux-mock-store'
import thunk from 'redux-thunk'
import { mount, shallow } from 'enzyme';
import ProviderMock from '../../__mocks__/providerMock';
import Home from '../../containers/Home';
import Header from '../../components/Header';
import Search from '../../components/Search';
import AllGames from '../../components/AllGames';
import Footer from '../../components/Footer';

const middlewares = [thunk]
const mockStore = configureMockStore(middlewares)

describe('<Home />', () => {
    let games = {"id":3498,"slug":"grand-theft-auto-v","name":"Grand Theft Auto V","released":"2013-09-17","tba":false,"background_image":"https://media.rawg.io/media/games/84d/84da2ac3fdfc6507807a1808595afb12.jpg","rating":4.48,"rating_top":5,"ratings":[{"id":5,"title":"exceptional","count":2887,"percent":59.2},{"id":4,"title":"recommended","count":1602,"percent":32.85},{"id":3,"title":"meh","count":308,"percent":6.32},{"id":1,"title":"skip","count":80,"percent":1.64}],"ratings_count":4823,"reviews_text_count":32,"added":15099,"added_by_status":{"yet":380,"owned":9010,"beaten":4016,"toplay":413,"dropped":733,"playing":547},"metacritic":97,"playtime":70,"suggestions_count":411,"updated":"2021-03-03T20:31:29","user_game":null,"reviews_count":4877,"saturated_color":"0f0f0f","dominant_color":"0f0f0f","platforms":[{"platform":{"id":187,"name":"PlayStation 5","slug":"playstation5","image":null,"year_end":null,"year_start":2020,"games_count":242,"image_background":"https://media.rawg.io/media/games/909/909974d1c7863c2027241e265fe7011f.jpg"},"released_at":"2013-09-17","requirements_en":null,"requirements_ru":null},{"platform":{"id":18,"name":"PlayStation 4","slug":"playstation4","image":null,"year_end":null,"year_start":null,"games_count":5967,"image_background":"https://media.rawg.io/media/games/b45/b45575f34285f2c4479c9a5f719d972e.jpg"},"released_at":"2013-09-17","requirements_en":null,"requirements_ru":null},{"platform":{"id":16,"name":"PlayStation 3","slug":"playstation3","image":null,"year_end":null,"year_start":null,"games_count":3625,"image_background":"https://media.rawg.io/media/games/562/562553814dd54e001a541e4ee83a591c.jpg"},"released_at":"2013-09-17","requirements_en":null,"requirements_ru":null},{"platform":{"id":14,"name":"Xbox 360","slug":"xbox360","image":null,"year_end":null,"year_start":null,"games_count":2718,"image_background":"https://media.rawg.io/media/games/e46/e462e92b46e8df13e78a806191610d47.jpg"},"released_at":"2013-09-17","requirements_en":null,"requirements_ru":null},{"platform":{"id":4,"name":"PC","slug":"pc","image":null,"year_end":null,"year_start":null,"games_count":336791,"image_background":"https://media.rawg.io/media/games/84d/84da2ac3fdfc6507807a1808595afb12.jpg"},"released_at":"2013-09-17","requirements_en":{"minimum":"Minimum:OS: Windows 10 64 Bit, Windows 8.1 64 Bit, Windows 8 64 Bit, Windows 7 64 Bit Service Pack 1, Windows Vista 64 Bit Service Pack 2* (*NVIDIA video card recommended if running Vista OS)Processor: Intel Core 2 Quad CPU Q6600 @ 2.40GHz (4 CPUs) / AMD Phenom 9850 Quad-Core Processor (4 CPUs) @ 2.5GHzMemory: 4 GB RAMGraphics: NVIDIA 9800 GT 1GB / AMD HD 4870 1GB (DX 10, 10.1, 11)Storage: 72 GB available spaceSound Card: 100% DirectX 10 compatibleAdditional Notes: Over time downloadable content and programming changes will change the system requirements for this game.  Please refer to your hardware manufacturer and www.rockstargames.com/support for current compatibility information. Some system components such as mobile chipsets, integrated, and AGP graphics cards may be incompatible. Unlisted specifications may not be supported by publisher.     Other requirements:  Installation and online play requires log-in to Rockstar Games Social Club (13+) network; internet connection required for activation, online play, and periodic entitlement verification; software installations required including Rockstar Games Social Club platform, DirectX , Chromium, and Microsoft Visual C++ 2008 sp1 Redistributable Package, and authentication software that recognizes certain hardware attributes for entitlement, digital rights management, system, and other support purposes.     SINGLE USE SERIAL CODE REGISTRATION VIA INTERNET REQUIRED; REGISTRATION IS LIMITED TO ONE ROCKSTAR GAMES SOCIAL CLUB ACCOUNT (13+) PER SERIAL CODE; ONLY ONE PC LOG-IN ALLOWED PER SOCIAL CLUB ACCOUNT AT ANY TIME; SERIAL CODE(S) ARE NON-TRANSFERABLE ONCE USED; SOCIAL CLUB ACCOUNTS ARE NON-TRANSFERABLE.  Partner Requirements:  Please check the terms of service of this site before purchasing this software.","recommended":"Recommended:OS: Windows 10 64 Bit, Windows 8.1 64 Bit, Windows 8 64 Bit, Windows 7 64 Bit Service Pack 1Processor: Intel Core i5 3470 @ 3.2GHz (4 CPUs) / AMD X8 FX-8350 @ 4GHz (8 CPUs)Memory: 8 GB RAMGraphics: NVIDIA GTX 660 2GB / AMD HD 7870 2GBStorage: 72 GB available spaceSound Card: 100% DirectX 10 compatibleAdditional Notes:"},"requirements_ru":null},{"platform":{"id":1,"name":"Xbox One","slug":"xbox-one","image":null,"year_end":null,"year_start":null,"games_count":4613,"image_background":"https://media.rawg.io/media/games/84d/84da2ac3fdfc6507807a1808595afb12.jpg"},"released_at":"2013-09-17","requirements_en":null,"requirements_ru":null},{"platform":{"id":186,"name":"Xbox Series S/X","slug":"xbox-series-x","image":null,"year_end":null,"year_start":2020,"games_count":226,"image_background":"https://media.rawg.io/media/games/fb5/fb5e0fdb1f6bb0e8b5da5d08bb83a5fc.jpg"},"released_at":"2013-09-17","requirements_en":null,"requirements_ru":null}],"parent_platforms":[{"platform":{"id":1,"name":"PC","slug":"pc"}},{"platform":{"id":2,"name":"PlayStation","slug":"playstation"}},{"platform":{"id":3,"name":"Xbox","slug":"xbox"}}],"genres":[{"id":4,"name":"Action","slug":"action","games_count":119778,"image_background":"https://media.rawg.io/media/games/d1a/d1a2e99ade53494c6330a0ed945fe823.jpg"},{"id":3,"name":"Adventure","slug":"adventure","games_count":87617,"image_background":"https://media.rawg.io/media/games/4e6/4e6e8e7f50c237d76f38f3c885dae3d2.jpg"}],"stores":[{"id":290375,"store":{"id":3,"name":"PlayStation Store","slug":"playstation-store","domain":"store.playstation.com","games_count":7648,"image_background":"https://media.rawg.io/media/games/c4b/c4b0cab189e73432de3a250d8cf1c84e.jpg"}},{"id":438095,"store":{"id":11,"name":"Epic Games","slug":"epic-games","domain":"epicgames.com","games_count":534,"image_background":"https://media.rawg.io/media/games/2ad/2ad87a4a69b1104f02435c14c5196095.jpg"}},{"id":290376,"store":{"id":1,"name":"Steam","slug":"steam","domain":"store.steampowered.com","games_count":52008,"image_background":"https://media.rawg.io/media/games/73e/73eecb8909e0c39fb246f457b5d6cbbe.jpg"}},{"id":290377,"store":{"id":7,"name":"Xbox 360 Store","slug":"xbox360","domain":"marketplace.xbox.com","games_count":1908,"image_background":"https://media.rawg.io/media/games/fc1/fc1307a2774506b5bd65d7e8424664a7.jpg"}},{"id":290378,"store":{"id":2,"name":"Xbox Store","slug":"xbox-store","domain":"microsoft.com","games_count":4188,"image_background":"https://media.rawg.io/media/games/9dd/9ddabb34840ea9227556670606cf8ea3.jpg"}}],"clip":null,"tags":[{"id":31,"name":"Singleplayer","slug":"singleplayer","language":"eng","games_count":118275,"image_background":"https://media.rawg.io/media/games/b7b/b7b8381707152afc7d91f5d95de70e39.jpg"},{"id":40847,"name":"Steam Achievements","slug":"steam-achievements","language":"eng","games_count":21942,"image_background":"https://media.rawg.io/media/games/b45/b45575f34285f2c4479c9a5f719d972e.jpg"},{"id":7,"name":"Multiplayer","slug":"multiplayer","language":"eng","games_count":25682,"image_background":"https://media.rawg.io/media/games/b8c/b8c243eaa0fbac8115e0cdccac3f91dc.jpg"},{"id":13,"name":"Atmospheric","slug":"atmospheric","language":"eng","games_count":13799,"image_background":"https://media.rawg.io/media/games/c4b/c4b0cab189e73432de3a250d8cf1c84e.jpg"},{"id":40836,"name":"Full controller support","slug":"full-controller-support","language":"eng","games_count":10211,"image_background":"https://media.rawg.io/media/games/fc1/fc1307a2774506b5bd65d7e8424664a7.jpg"},{"id":42,"name":"Great Soundtrack","slug":"great-soundtrack","language":"eng","games_count":3140,"image_background":"https://media.rawg.io/media/games/73e/73eecb8909e0c39fb246f457b5d6cbbe.jpg"},{"id":24,"name":"RPG","slug":"rpg","language":"eng","games_count":11918,"image_background":"https://media.rawg.io/media/games/91c/91c4f377c1e09755b60a0102c5252843.jpg"},{"id":18,"name":"Co-op","slug":"co-op","language":"eng","games_count":6800,"image_background":"https://media.rawg.io/media/games/d0f/d0f91fe1d92332147e5db74e207cfc7a.jpg"},{"id":36,"name":"Open World","slug":"open-world","language":"eng","games_count":3805,"image_background":"https://media.rawg.io/media/games/91c/91c4f377c1e09755b60a0102c5252843.jpg"},{"id":411,"name":"cooperative","slug":"cooperative","language":"eng","games_count":2823,"image_background":"https://media.rawg.io/media/games/588/588c6bdff3d4baf66ec36b1c05b793bf.jpg"},{"id":8,"name":"First-Person","slug":"first-person","language":"eng","games_count":13183,"image_background":"https://media.rawg.io/media/games/ed5/ed5b7d01dd68fd8d598c91ad61f153af.jpg"},{"id":149,"name":"Third Person","slug":"third-person","language":"eng","games_count":4451,"image_background":"https://media.rawg.io/media/games/e2d/e2d3f396b16dded0f841c17c9799a882.jpg"},{"id":4,"name":"Funny","slug":"funny","language":"eng","games_count":13574,"image_background":"https://media.rawg.io/media/games/dd5/dd50d4266915d56dd5b63ae1bf72606a.jpg"},{"id":37,"name":"Sandbox","slug":"sandbox","language":"eng","games_count":3557,"image_background":"https://media.rawg.io/media/games/849/849414b978db37d4563ff9e4b0d3a787.jpg"},{"id":123,"name":"Comedy","slug":"comedy","language":"eng","games_count":6535,"image_background":"https://media.rawg.io/media/games/af7/af7a831001c5c32c46e950cc883b8cb7.jpg"},{"id":150,"name":"Third-Person Shooter","slug":"third-person-shooter","language":"eng","games_count":1538,"image_background":"https://media.rawg.io/media/games/d69/d69810315bd7e226ea2d21f9156af629.jpg"},{"id":62,"name":"Moddable","slug":"moddable","language":"eng","games_count":550,"image_background":"https://media.rawg.io/media/games/7a2/7a2500ee8b2c0e1ff268bb4479463dea.jpg"},{"id":144,"name":"Crime","slug":"crime","language":"eng","games_count":1826,"image_background":"https://media.rawg.io/media/games/73e/73eecb8909e0c39fb246f457b5d6cbbe.jpg"},{"id":62349,"name":"vr mod","slug":"vr-mod","language":"eng","games_count":19,"image_background":"https://media.rawg.io/media/games/bda/bdab2603c0dc67268d0610449bc7df16.jpg"}],"esrb_rating":{"id":4,"name":"Mature","slug":"mature"},"short_screenshots":[{"id":-1,"image":"https://media.rawg.io/media/games/84d/84da2ac3fdfc6507807a1808595afb12.jpg"},{"id":1827221,"image":"https://media.rawg.io/media/screenshots/a7c/a7c43871a54bed6573a6a429451564ef.jpg"},{"id":1827222,"image":"https://media.rawg.io/media/screenshots/cf4/cf4367daf6a1e33684bf19adb02d16d6.jpg"},{"id":1827223,"image":"https://media.rawg.io/media/screenshots/f95/f9518b1d99210c0cae21fc09e95b4e31.jpg"},{"id":1827225,"image":"https://media.rawg.io/media/screenshots/a5c/a5c95ea539c87d5f538763e16e18fb99.jpg"},{"id":1827226,"image":"https://media.rawg.io/media/screenshots/a7e/a7e990bc574f4d34e03b5926361d1ee7.jpg"},{"id":1827227,"image":"https://media.rawg.io/media/screenshots/592/592e2501d8734b802b2a34fee2df59fa.jpg"}]};

    let myGames = {"id":"9b4d6f77-8a94-4713-963e-210a82fad1a3","name":"Pokemon","description":"Arceus","released":"2021-06-10","rating":6,"platforms":["PC"],"image":"https://legends.pokemon.com/assets/img/global/es-es/th-video.jpg","createdAt":"2021-06-16T19:43:31.551Z","updatedAt":"2021-06-16T19:43:31.551Z","genres":[{"id":2,"name":"Action","Video_Genre":{"createdAt":"2021-06-16T19:43:32.265Z","updatedAt":"2021-06-16T19:43:32.265Z","videogameId":"9b4d6f77-8a94-4713-963e-210a82fad1a3","genreId":2}},{"id":3,"name":"Adventure","Video_Genre":{"createdAt":"2021-06-16T19:43:32.274Z","updatedAt":"2021-06-16T19:43:32.274Z","videogameId":"9b4d6f77-8a94-4713-963e-210a82fad1a3","genreId":3}}]};
    
    const store = mockStore({});

    let home = mount(
        <ProviderMock store={store} >
            <Home games={games} myGames={myGames}/>
        </ProviderMock>
    );

    let genres = [{"id":1,"name":"Action","createdAt":"2021-06-15T19:00:02.589Z","updatedAt":"2021-06-15T19:00:02.589Z"},{"id":2,"name":"Indie","createdAt":"2021-06-15T19:00:02.936Z","updatedAt":"2021-06-15T19:00:02.936Z"},{"id":3,"name":"Casual","createdAt":"2021-06-15T19:00:02.961Z","updatedAt":"2021-06-15T19:00:02.961Z"},{"id":4,"name":"Simulation","createdAt":"2021-06-15T19:00:03.016Z","updatedAt":"2021-06-15T19:00:03.016Z"},{"id":5,"name":"Shooter","createdAt":"2021-06-15T19:00:02.958Z","updatedAt":"2021-06-15T19:00:02.958Z"},{"id":6,"name":"Adventure","createdAt":"2021-06-15T19:00:02.949Z","updatedAt":"2021-06-15T19:00:02.949Z"},{"id":7,"name":"RPG","createdAt":"2021-06-15T19:00:02.944Z","updatedAt":"2021-06-15T19:00:02.944Z"},{"id":8,"name":"Puzzle","createdAt":"2021-06-15T19:00:03.026Z","updatedAt":"2021-06-15T19:00:03.026Z"},{"id":9,"name":"Strategy","createdAt":"2021-06-15T19:00:02.956Z","updatedAt":"2021-06-15T19:00:02.956Z"},{"id":10,"name":"Arcade","createdAt":"2021-06-15T19:00:03.040Z","updatedAt":"2021-06-15T19:00:03.040Z"},{"id":11,"name":"Platformer","createdAt":"2021-06-15T19:00:03.048Z","updatedAt":"2021-06-15T19:00:03.048Z"},{"id":12,"name":"Racing","createdAt":"2021-06-15T19:00:03.056Z","updatedAt":"2021-06-15T19:00:03.056Z"},{"id":13,"name":"Massively Multiplayer","createdAt":"2021-06-15T19:00:03.058Z","updatedAt":"2021-06-15T19:00:03.058Z"},{"id":14,"name":"Sports","createdAt":"2021-06-15T19:00:03.065Z","updatedAt":"2021-06-15T19:00:03.065Z"},{"id":15,"name":"Fighting","createdAt":"2021-06-15T19:00:03.075Z","updatedAt":"2021-06-15T19:00:03.075Z"},{"id":16,"name":"Family","createdAt":"2021-06-15T19:00:03.078Z","updatedAt":"2021-06-15T19:00:03.078Z"},{"id":17,"name":"Board Games","createdAt":"2021-06-15T19:00:03.079Z","updatedAt":"2021-06-15T19:00:03.079Z"},{"id":18,"name":"Educational","createdAt":"2021-06-15T19:00:03.081Z","updatedAt":"2021-06-15T19:00:03.081Z"},{"id":19,"name":"Card","createdAt":"2021-06-15T19:00:03.083Z","updatedAt":"2021-06-15T19:00:03.083Z"}];
    

    it('Render del componente Home', () => {
        expect(home.length).toEqual(1);
    });
    
    it('Debe renderizar <Header /> una sola vez', () => {
        expect(home.find(Header)).toHaveLength(1);
    });

    it('Debe renderizar <Search /> una sola vez', () => {
        expect(home.find(Search)).toHaveLength(1);
    });

    xit('<Search /> debe recibir genres por prop con el valor "genres" ', () => {
        expect(home.find('Search').props()).toEqual('genres')
    })

    it('No debe renderizar <AllGames /> si games y myGames son undefined', () => {
        expect(home.find('AllGames')).toHaveLength(0);
    });

    xit('Debe renderizar <AllGames /> dos veces', () => {
        home.update();
        expect(home.find('AllGames')).toHaveLength(2);
    });

    it('Debe renderizar <Footer /> una sola vez', () => {
        expect(home.find(Footer)).toHaveLength(1);
    });
});
